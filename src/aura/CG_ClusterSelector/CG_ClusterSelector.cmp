<aura:component controller="CG_ClusterSelectorController"  implements="flexipage:availableForRecordHome,forceCommunity:availableForAllPageTypes" access="global">
    
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    
    <aura:attribute name="clusterExternalID" type="String"/>
    <aura:attribute name="componentId" type="Id"/>
    <aura:attribute name="isBackend" type="Boolean" default="false"/>
    <aura:attribute name="isLivePreview" type="Boolean" default="false"/>

    <aura:attribute name="tree" type="Object" />

    <aura:if isTrue="{!not(empty(v.tree))}">

        <div class="slds-tree_container">

            <a class="{!v.tree.leafOnly? 'slds-tree__item-label unclickable-span':'slds-tree__item-label'}" data-clusterId="{!v.tree.name}" data-clustertype="{!v.tree.clustertype}" data-clusterLanding="{!v.tree.clusterLanding}" onclick="{!c.doOnclick}">
                <h4 class="slds-text-title_caps" id="treeheading">{!v.tree.label}</h4>
            </a>
            <div class="slds-grid">

                <aura:iteration items="{!v.tree.items}" var="item">
                    
                    <div class="slds-col">
                        
                        <ul class="slds-tree" role="tree" aria-labelledby="treeheading">
                            <li aura:id="{!item.name}" role="treeitem" aria-level="1" aria-expanded="true" aria-label="{!item.label}">
                                <div class="slds-tree__item">
                                    <aura:if isTrue="{!item.expanded}">
                                        <!--
               <button class="slds-button slds-button_icon slds-m-right_x-small" aria-hidden="true" tabindex="-1" title="{!'Expand ' + item.label}" onclick="" data-clusterId="{!item.name}">
                  <lightning:icon class="iconClass" iconName="utility:chevronright" size="3" />
               </button>
              -->
                                    </aura:if>                  
                                    <span class="slds-has-flexi-truncate">
                                        <span class="{!item.leafOnly? 'slds-tree__item-label slds-truncate unclickable-span':'slds-tree__item-label slds-truncate'}" title="{!item.label}" data-clusterId="{!item.name}" data-clusterLanding="{!item.clusterLanding}" data-clustertype="{!item.clustertype}" onclick="{!c.doOnclick}" >{!item.label}</span>
                                    </span>
                                    
                                </div>
                                <aura:iteration items="{!item.items}" var="subItem">
                                    <ul lass="slds-tree" role="group" aria-labelledby="treeheading">
                                        <li aura:id="{!subItem.name}" role="treeitem" aria-level="2" aria-expanded="true" aria-label="{!subItem.label}">
                                            <div class="slds-tree__item">
                                                <aura:if isTrue="{!subItem.expanded}">
                                                    <!--
                     <button class="slds-button slds-button_icon slds-m-right_x-small" aria-hidden="true" tabindex="-1" title="{!'Expand ' + subItem.label}" data-clusterId="{!subItem.name}" onclick="">
                        <lightning:icon class="iconClass" iconName="utility:chevronright" />
                     </button>
                    -->
                                                </aura:if>
                                                <span class="slds-has-flexi-truncate">
                                                    <span class="{!subItem.leafOnly? 'slds-tree__item-label slds-truncate unclickable-span':'slds-tree__item-label slds-truncate'}" title="{!subItem.label}" data-clusterId="{!subItem.name}" data-clusterLanding="{!subItem.clusterLanding}" data-clustertype="{!subItem.clustertype}" onclick="{!c.doOnclick}">{!subItem.label}</span>
                                                </span>
                                            </div>
                                            <aura:iteration items="{!subItem.items}" var="subItem1">
                                                <ul lass="slds-tree" role="group" aria-labelledby="treeheading">
                                                    <li role="treeitem" aria-level="3" aria-label="{!subItem1.label}">
                                                        <div class="slds-tree__item">
                                                            <span class="slds-has-flexi-truncate">
                                                                <span class="slds-tree__item-label slds-truncate" title="{!subItem1.label}" data-clusterId="{!subItem1.name}" data-clusterLanding="{!subItem1.clusterLanding}" data-clustertype="{!subItem1.clustertype}" onclick="{!c.doOnclick}">{!subItem1.label}</span>
                                                            </span>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </aura:iteration>
                                        </li>
                                    </ul>
                                </aura:iteration>
                            </li>
                        </ul>
                    </div>
                </aura:iteration>
            </div>
        </div>
    </aura:if>
    <aura:If isTrue="{!v.isLivePreview}">
        <aura:If isTrue="{!v.clusterExternalID == ''}">
            <div class="slds-page-header" style="text-align: center;">
                <lightning:layout horizontalAlign="left">
                    <lightning:layoutItem size="12" flexibility="auto" padding="around-small">
                        <h1 class="slds-page-header__title slds-text-heading_large">Cluster Selector</h1>
                        <p>{!$Label.c.ComponentEmpty}</p>
                    </lightning:layoutItem>
                </lightning:layout>
            </div>
            <aura:set attribute="else">
                <aura:if isTrue="{!v.tree.clustertype == null}">
                    <div class="slds-page-header" style="text-align: center;">
                        <lightning:layout horizontalAlign="left">
                            <lightning:layoutItem size="12" flexibility="auto" padding="around-small">
                                <h1 class="slds-page-header__title slds-text-heading_large">Cluster Selector</h1>
                                <p>{!$Label.c.IncorrectExternalId}</p>
                            </lightning:layoutItem>
                        </lightning:layout>
                    </div>
                </aura:if>    
            </aura:set>
        </aura:If>
    </aura:If>
    
</aura:component>